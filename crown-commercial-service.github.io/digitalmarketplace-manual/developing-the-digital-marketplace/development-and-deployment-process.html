

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Development and deployment process &mdash; digitalmarketplace-manual 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Migrating the Digital Marketplace frontend" href="frontend-migration.html" />
    <link rel="prev" title="Data model" href="data-model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> digitalmarketplace-manual
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Digital Marketplace background</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../digital-marketplace-background/deportalising.html">History: From G-Cloud 5 to G-Cloud 8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digital-marketplace-background/finding-things.html">Finding Things</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digital-marketplace-background/journeys.html">User Journeys on the Digital Marketplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../digital-marketplace-background/gdpr.html">GDPR</a></li>
</ul>
<p class="caption"><span class="caption-text">Developing the Digital Marketplace</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="accessing-the-api.html">Accessing the API</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding-repos.html">Adding a new repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="application-architecture.html">Application architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="browser-support.html">Browser and accessibility support</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer-setup.html">Developer setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="decision-records.html">Recording decisions on the Digital Marketplace</a></li>
<li class="toctree-l1"><a class="reference internal" href="digitalmarketplace-runner.html">Digital Marketplace Runner (‘dmrunner’)</a></li>
<li class="toctree-l1"><a class="reference internal" href="nix.html">Nix Environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-model.html">Data model</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Development and deployment process</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#story-kickoff">Story Kickoff</a></li>
<li class="toctree-l2"><a class="reference internal" href="#develop-locally-on-feature-branches">Develop locally on feature branches</a></li>
<li class="toctree-l2"><a class="reference internal" href="#open-a-pull-request">Open a pull request</a></li>
<li class="toctree-l2"><a class="reference internal" href="#request-review">Request review</a></li>
<li class="toctree-l2"><a class="reference internal" href="#merge">Merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-on-shared-repositories">Working on shared repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-on-preview">Test on preview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-to-staging">Deploy to staging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deploy-to-production">Deploy to production</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="frontend-migration.html">Migrating the Digital Marketplace frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="moving-data.html">Moving data between environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="urls.html">URLs</a></li>
<li class="toctree-l1"><a class="reference internal" href="users.html">Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="google-analytics.html">Google Analytics</a></li>
<li class="toctree-l1"><a class="reference internal" href="load-testing.html">Load testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="automated-testing.html">Automated testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="splitting-applications.html">Splitting or adding a frontend application</a></li>
<li class="toctree-l1"><a class="reference internal" href="database-migrations.html">Database migrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker-strategies.html">Docker strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend-assets-and-tools.html">Frontend assets and tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="python-typing-strategy.html">Python typing strategy</a></li>
<li class="toctree-l1"><a class="reference internal" href="production-guidelines.html">Guidelines for accessing production data and systems</a></li>
</ul>
<p class="caption"><span class="caption-text">Content and frameworks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/adding-frameworks.html">Preparing to add a new framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/framework-lifecycle-for-developers.html">Framework lifecycle for developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/how-suppliers-apply-to-a-framework.html">How suppliers apply to a framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/framework-agreements.html">Framework agreements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/contract-variations.html">Contract variations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/adding-a-new-form-field-type.html">Adding a new form field type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/finding-content.html">Finding content</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/changing-content.html">Changing content</a></li>
<li class="toctree-l1"><a class="reference internal" href="../content-and-frameworks/useful-api-endpoints-for-frameworks.html">Useful API endpoints for frameworks</a></li>
</ul>
<p class="caption"><span class="caption-text">Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/antivirus.html">The Antivirus API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/aws-accounts.html">AWS accounts and access</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/aws-resources.html">AWS Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/code-backups.html">Code backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/database-backups.html">Database backups</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/domains.html">Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/emails.html">Email integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/elasticsearch.html">Elasticsearch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/jenkins.html">Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/github-actions.html">GitHub Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/logging.html">Logging, monitoring and alerting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/maintenance-mode.html">Maintenance Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/python-environments.html">Python environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/paas.html">What is PaaS?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/paas.html#deploying-digital-marketplace-apps-to-gov-uk-paas">Deploying Digital Marketplace apps to GOV.UK PaaS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/rate-limiting.html">Rate Limiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/upgrading-backend-services.html">Upgrading backend services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/session-management.html">Session Management</a></li>
</ul>
<p class="caption"><span class="caption-text">Managing People and Secret Things</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../managing-people-and-secret-things/credentials.html">Credentials and secrets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../managing-people-and-secret-things/accounts.html">Adding and removing access for new starters / leavers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../managing-people-and-secret-things/production-access.html">Requirements for access to production environments</a></li>
</ul>
<p class="caption"><span class="caption-text">2nd Line Runbook</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/incidents.html">Incidents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/logging-in-to-paas-databases.html">Logging in to databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/logging-in-to-paas-databases.html#resetting-brief-data-with-conduit">Resetting brief data with conduit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/blocking-ips.html">IP Restrictions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/upgrading-jenkins.html">Upgrading Jenkins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/rebuilding-jenkins.html">Rebuilding Jenkins from scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/rotate-keys.html">Rotating API keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/debugging-paas-app-instances.html">Debugging PaaS App Instances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/vulnerability-scanning.html">Vulnerability scanning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/novations.html">Novations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/support-tasks.html">Support Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/investigating-alerts.html">Responding to Cloudwatch alerts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../2nd-line-runbook/buyer-domain-allow-list.html">Buyer Domain Allow List</a></li>
</ul>
<p class="caption"><span class="caption-text">What is this?</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/alphagov/digitalmarketplace-manual/blob/master/README.md">README</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">digitalmarketplace-manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Development and deployment process</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/Crown-Commercial-Service/digitalmarketplace-manual/blob/main/manual/developing-the-digital-marketplace/development-and-deployment-process.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="development-and-deployment-process">
<span id="deployment"></span><h1><a class="toc-backref" href="#id3">Development and deployment process</a><a class="headerlink" href="#development-and-deployment-process" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#development-and-deployment-process" id="id3">Development and deployment process</a></p>
<ul>
<li><p><a class="reference internal" href="#story-kickoff" id="id4">Story Kickoff</a></p></li>
<li><p><a class="reference internal" href="#develop-locally-on-feature-branches" id="id5">Develop locally on feature branches</a></p></li>
<li><p><a class="reference internal" href="#open-a-pull-request" id="id6">Open a pull request</a></p></li>
<li><p><a class="reference internal" href="#request-review" id="id7">Request review</a></p></li>
<li><p><a class="reference internal" href="#merge" id="id8">Merge</a></p></li>
<li><p><a class="reference internal" href="#working-on-shared-repositories" id="id9">Working on shared repositories</a></p></li>
<li><p><a class="reference internal" href="#test-on-preview" id="id10">Test on preview</a></p></li>
<li><p><a class="reference internal" href="#deploy-to-staging" id="id11">Deploy to staging</a></p></li>
<li><p><a class="reference internal" href="#deploy-to-production" id="id12">Deploy to production</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If in doubt discuss with other developers in the <a class="reference external" href="https://gds.slack.com/app_redirect?channel=dm-development">#dm-development</a> Slack channel</p>
</div>
<p>This manual page describes the day to day work of a developer on the Digital Marketplace, much of which will be writing
and reviewing pull requests. It supplements (and in some cases supersedes) the <a class="reference external" href="https://gds-way.cloudapps.digital/">GDS Way</a>, particular the pages on <a class="reference external" href="https://gds-way.cloudapps.digital/standards/source-code.html">how
to store source code</a>, <a class="reference external" href="https://gds-way.cloudapps.digital/manuals/code-review-guidelines.html">how to review code</a>, and the <a class="reference external" href="https://gds-way.cloudapps.digital/standards/pull-requests.html">page on pull requests</a> in general.</p>
<div class="section" id="story-kickoff">
<h2><a class="toc-backref" href="#id4">Story Kickoff</a><a class="headerlink" href="#story-kickoff" title="Permalink to this headline">¶</a></h2>
<p>So, you’re looking at the ticket at the top of your team’s backlog and are about to start work building out the
feature…</p>
<p>Before even thinking about beginning to touch a line of code, do a story kickoff.  Talk to anyone on the team who might
have an opinion about the technical implementation or is likely to be affected by changes to the interface and hash out
what the solution to your particular problem might look like. A list of interested people may be in the story.  By the
time you claim the story on Trello it should be abundantly clear what your goals are.</p>
</div>
<div class="section" id="develop-locally-on-feature-branches">
<h2><a class="toc-backref" href="#id5">Develop locally on feature branches</a><a class="headerlink" href="#develop-locally-on-feature-branches" title="Permalink to this headline">¶</a></h2>
<p>We develop all our code on Git feature branches and review these via <a class="reference external" href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests">GitHub pull requests</a>.</p>
<p>We typically develop locally using <a class="reference internal" href="developer-setup.html#digitalmarketplace-runner-heading"><span class="std std-ref">Digital Marketplace Runner</span></a>.</p>
</div>
<div class="section" id="open-a-pull-request">
<h2><a class="toc-backref" href="#id6">Open a pull request</a><a class="headerlink" href="#open-a-pull-request" title="Permalink to this headline">¶</a></h2>
<p>When development of a feature is complete and the application level tests pass locally open a pull request. This will
cause Github Actions to run the application tests and update the pull request. From this point on the developer who
opened the pull request is responsible for ensuring the feature moves through the deployment process.</p>
<p>If there is a Trello card for the work you are doing paste the link to the card into the pull request message. The <a class="reference external" href="https://github.com/emmabeynon/github-trello-poster">GitHub Trello
poster</a> will then add a link to your pull request to the Trello card for you <a class="footnote-reference brackets" href="#id2" id="id1">1</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>To set up the GitHub Trello poster you need to add a webhook to the repo and add the GTP user to the Trello
board. See the <a class="reference external" href="https://github.com/emmabeynon/github-trello-poster">GitHub Trello poster</a> README for details.</p>
</dd>
</dl>
</div>
<div class="section" id="request-review">
<h2><a class="toc-backref" href="#id7">Request review</a><a class="headerlink" href="#request-review" title="Permalink to this headline">¶</a></h2>
<p>As soon as you’re happy with the pull request description it’s time to request review. Post a link to the pull request
in the <a class="reference external" href="https://gds.slack.com/app_redirect?channel=dm-review">#dm-review</a> channel. All developers on the Digital Marketplace should be a member of this channel and watch it
regularly for new pull requests, but if someone doesn’t look at your pull request by the end of the day it will be
reposted by the <a class="reference external" href="https://github.com/alphagov/seal/">alphagov seal bot</a> at the beginning of the next day. If your pull request needs to be urgently
reviewed make sure to mention that when posting the link to the pull request.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All developers should be involved in reviewing pull requests (although only one approval is needed
before merging).</p>
<p>It isn’t expected that everyone reads every pull request, but everyone should be spending a small
amount of time each day reviewing. Don’t be shy about reviewing code you’re unfamiliar with - it’s a good time to
ask questions and learn about the broader codebase. However make sure you understand the changes before approving.</p>
<p>We review pull requests with the <a class="reference external" href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-request-reviews">review tool</a> on GitHub. Discussion, questions, and constructive feedback are
all encouraged and expected; also don’t forget to leave friendly emojis!</p>
</div>
<p>Reviewers may approve your pull request without comment, approve it with a comment and expect you to action the
comment before merging (trusting that you will), or leave comments without approving if they have unresolved
questions or concerns.</p>
<p>You can update your pull request as many times as you want before merging, although you might want to avoid making
big changes after it has been approved. You should use <a class="reference external" href="https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History">git rebase</a> liberally to keep the commits based on the
current master branch and the history clean (the exception to this is when pairing on a pull request, when it’s
better to wait until it’s ready for merging before rebasing).</p>
</div>
<div class="section" id="merge">
<h2><a class="toc-backref" href="#id8">Merge</a><a class="headerlink" href="#merge" title="Permalink to this headline">¶</a></h2>
<p>Once your reviewers have reviewed the pull request and are happy with the proposed changes they will approve it using
the GitHub review tool. This indicates that you’re clear to merge it when you’re ready. It is not easy to change a pull
request once merged, so at the point of merging a pull request everyone implicated should agree on the implemented
solution.</p>
<p>Merging a pull request on one of the main Flask applications will automatically kick off a series of steps involved
in deploying to preview:</p>
<ol class="arabic simple">
<li><p>The application is tagged with the git hash that caused the build <code class="docutils literal notranslate"><span class="pre">release-&lt;git</span> <span class="pre">short</span> <span class="pre">hash&gt;</span></code>.</p></li>
<li><p>An artifact is built for this tag and deployed to preview.</p></li>
<li><p>Once the deployment is complete a run of the functional and visual regression tests will be started.</p></li>
</ol>
</div>
<div class="section" id="working-on-shared-repositories">
<span id="shared-repositories"></span><h2><a class="toc-backref" href="#id9">Working on shared repositories</a><a class="headerlink" href="#working-on-shared-repositories" title="Permalink to this headline">¶</a></h2>
<p>Several of our repositories contain shared code used by our different applications:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/alphagov/digitalmarketplace-apiclient">digitalmarketplace-apiclient</a></p></li>
<li><p><a class="reference external" href="https://github.com/alphagov/digitalmarketplace-content-loader">digitalmarketplace-content-loader</a></p></li>
<li><p><a class="reference external" href="https://github.com/alphagov/digitalmarketplace-frameworks">digitalmarketplace-frameworks</a></p></li>
<li><p><a class="reference external" href="https://github.com/alphagov/digitalmarketplace-frontend-toolkit">digitalmarketplace-frontend-toolkit</a></p></li>
<li><p><a class="reference external" href="https://github.com/alphagov/digitalmarketplace-utils">digitalmarketplace-utils</a></p></li>
<li><p><a class="reference external" href="https://github.com/alphagov/digitalmarketplace-test-utils">digitalmarketplace-test-utils</a></p></li>
</ul>
<p>When updating any of these we need to publish a new version (tagged with a new version number) when we want to share
changes. So before making a pull-request with changes in one of these repositories, you need to update the version
number on your working branch – the location of this varies depending on the type of repository you’re working
with.</p>
<blockquote>
<div><ul class="simple">
<li><p>Node repositories such as the <code class="docutils literal notranslate"><span class="pre">frameworks</span></code> and <code class="docutils literal notranslate"><span class="pre">frontend-toolkit</span></code>
repos both define the version as part of their <code class="docutils literal notranslate"><span class="pre">package.json</span></code> manifest</p></li>
<li><p>Python repositories such as the <code class="docutils literal notranslate"><span class="pre">apiclient</span></code>, <code class="docutils literal notranslate"><span class="pre">content-loader</span></code> and
<code class="docutils literal notranslate"><span class="pre">utils</span></code> repos have an <code class="docutils literal notranslate"><span class="pre">__init__.py</span></code> file inside of their Python
module folder which contains <code class="docutils literal notranslate"><span class="pre">__version__</span></code></p></li>
</ul>
</div></blockquote>
<p>Once your pull request bumping the version is merged, one of two things will happen: either</p>
<blockquote>
<div><ul class="simple">
<li><p>Jenkins will automatically run the <a class="reference external" href="https://github.com/alphagov/digitalmarketplace-utils/blob/master/scripts/push-tag.sh">push-tag.sh</a> script.  This will create a
git tag with the version number you supplied, thus making it possible to clone the exact version of the code</p></li>
</ul>
</div></blockquote>
<p>or</p>
<blockquote>
<div><ul class="simple">
<li><p>A GitHub Action will run, creating a GitHub release and then publishing the package to the appropriate package
repository (NPM or PyPI). For more information about these actions read <a class="reference internal" href="../infrastructure/github-actions.html#github-actions"><span class="std std-ref">GitHub Actions</span></a>.</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="test-on-preview">
<h2><a class="toc-backref" href="#id10">Test on preview</a><a class="headerlink" href="#test-on-preview" title="Permalink to this headline">¶</a></h2>
<p>Once the application has been deployed to preview, the smoke tests, functional tests and visual regression tests will be
run automatically. After they have both passed it is ready to be viewed on preview.</p>
<p>You should consider doing some manual testing of your own when a change has been made on preview. For larger changes and
new features you may also want to take some screenshots to share with your team’s product manager, or have them go
through the journey themselves.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Larger changes should ideally have feature tests and visual regression tests added to the respective suites.</p>
</div>
<p>Preview can be found at: <a class="reference external" href="https://www.preview.marketplace.team/">https://www.preview.marketplace.team/</a></p>
</div>
<div class="section" id="deploy-to-staging">
<h2><a class="toc-backref" href="#id11">Deploy to staging</a><a class="headerlink" href="#deploy-to-staging" title="Permalink to this headline">¶</a></h2>
<p>Deploying to staging is the first step of deploying a feature to production. Our staging environment acts as a backstop
to catch any breaking changes before deploying to production; usually only one change from production should be present
in staging at a time, and not for very long.</p>
<p>Before deploying to staging or production the feature must have been OK’d for release by doing some manual testing and
discussing with the product manager if necessary.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because of limitations of our current release process, the longer your change sits in preview without being deployed,
the more likely it will be that you will be unable to release it without also releasing another developer’s changes.</p>
</div>
<p>Be sure to check that all changes going out in your release have been OK’d. We have a lag radiator that can help with
this, it shows how many merges are undeployed for each app. Clicking on the name for each app links to a GitHub page
with all undeployed commits. To access the lag radiator decrypt <a class="reference external" href="https://github.com/alphagov/digitalmarketplace-credentials/blob/master/links.yaml">digitalmarketplace-credentials/links.yaml</a> and
bookmark the <code class="docutils literal notranslate"><span class="pre">deploy_lag_radiator</span></code> URL. Please don’t share it in plaintext, as it contains an API key.</p>
<p>When you’re ready to go <strong>take the Gorilla of Deploy - YOLO - and keep it close!</strong></p>
<p>Check the channel topic in the <a class="reference external" href="https://gds.slack.com/app_redirect?channel=dm-2ndline">#dm-2ndline</a> Slack channel indicates it is currently free.</p>
<p>If the Deploy Lag Radiator shows there are other team members’ commits included in the deploy; tag them in a message in the <a class="reference external" href="https://gds.slack.com/app_redirect?channel=dm-2ndline">#dm-2ndline</a> Slack channel; so they are aware their changes are about to be deployed.</p>
<p>Update the channel topic in the <a class="reference external" href="https://gds.slack.com/app_redirect?channel=dm-2ndline">#dm-2ndline</a> Slack channel to indicate you are deploying.</p>
<p>Find the relevant <a class="reference external" href="https://ci.marketplace.team/view/Release/">release pipeline job</a> for the app you’re releasing in Jenkins, hover your mouse pointer over the
“release to staging” box and click “Proceed”. This will take the artefact for the version of the application currently
deployed into preview and deploy it to staging.</p>
<p>Once deployment to staging is complete a run of the functional tests will be started - you will be notified of the
result in the <a class="reference external" href="https://gds.slack.com/app_redirect?channel=dm-2ndline">#dm-2ndline</a> Slack channel once it completes. You should see these tests pass before promoting any
changes to production. If tests fail either fix the tests or fix your code before taking it any further.</p>
<p>For high risk changes or changes you could not manually test on preview you may also want to do manual testing on
staging. Once you’ve deployed you can check your work at: <a class="reference external" href="https://www.staging.marketplace.team/">https://www.staging.marketplace.team/</a>.</p>
<p>You can view its status at the <code class="docutils literal notranslate"><span class="pre">_status</span></code> endpoint, e.g. <a class="reference external" href="https://www.staging.marketplace.team/suppliers/_status">https://www.staging.marketplace.team/suppliers/_status</a> for the
supplier frontend.</p>
</div>
<div class="section" id="deploy-to-production">
<h2><a class="toc-backref" href="#id12">Deploy to production</a><a class="headerlink" href="#deploy-to-production" title="Permalink to this headline">¶</a></h2>
<p>Once the staging functional tests have successfully passed and you’re happy to go to production, visit the same pipeline
job in Jenkins, hover your mouse pointer over the “release to production” box and click “Proceed”.</p>
<p>This will deploy the artefact currently in staging into production.</p>
<p>You should now check the feature works as expected on the <a class="reference external" href="https://www.digitalmarketplace.service.gov.uk">live site</a>. Once we’re happy the feature is live it is <strong>DONE</strong>!</p>
<p><strong>Release YOLO back into the wild.</strong></p>
<p>Update the channel topic in the <a class="reference external" href="https://gds.slack.com/app_redirect?channel=dm-2ndline">#dm-2ndline</a> Slack channel to indicate it is free.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="frontend-migration.html" class="btn btn-neutral float-right" title="Migrating the Digital Marketplace frontend" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="data-model.html" class="btn btn-neutral float-left" title="Data model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2013 - 2021 Digital Marketplace

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>